{% extends 'base.html' %}
{% load get_range %}

{% block title %}{{ project }} - {% endblock %}

{% block content %}
{% if user in project.owners.all %}
    <div class="subcontainer sc_small right">
        <div class="subcontainer_h">
            Admin
        </div>
        <div class="subcontainer_c">
            <li><a href="{% url 'projects:edit_project' project.pk %}">Edit Project</a></li>
            <li><a href="{% url 'projects:manage_users' project.pk %}">Manage workers</a></li>
            <li><a href="{% url 'projects:start_project' project.pk %}">Start Subproject</a></li>
            {% if project.owners.all.count > 1 %}
                <li><a href="{% url 'projects:owner_resign' project.pk %}">Resign from project</a></li>
            {% endif %}
            <li><a href="{% url 'projects:delete_project' project.pk %}">Delete Project</a></li>
        </div>
    </div>
{% endif %}
<div class="subcontainer sc_large left">
    <div class="subcontainer_h">
        {% for pp in project.project_root %}
            <a href="{% url 'projects:projectpage' pp.pk %}">{{ pp.name }}</a> /
        {% endfor %}
        {{ project.name }}
    </div>
    <div class="subcontainer_c pure_li ul_a">
        {% autoescape off %}{{ desc|default:'No description' }}{% endautoescape %}
        <h4>Languages used:</h4>
        {{ project.langs.all|join:", " }}
        <h4>Skills used:</h4>
        {{ project.skills.all|join:", " }}
    </div>
</div>
{% if project.seeking == 'Yes' or user in project.owners.all and user not in project.users.all %}
    <div class="subcontainer sc_small right">
        <div class="subcontainer_h">
            Work
        </div>
        <div class="subcontainer_c">
            <a href="{% url 'projects:startwork' project.pk %}">Work on this project</a>
        </div>
    </div>
{% elif user in project.users.all %}
    <div class="subcontainer sc_small right">
        <div class="subcontainer_h">
            Work
        </div>
        <div class="subcontainer_c">
            <a href="{% url 'projects:finishwork' project.pk %}">Stop working on this project</a>
        </div>
    </div>
{% endif %}
<div class="subcontainer sc_small right">
    <div class="subcontainer_h">
        Project owners
    </div>
    <div class="subcontainer_c">
        {% for u in project.owners.all %}
            <li><a href="{% url 'projects:profilepage' u.pk %}">{{ u }}</a></li>
        {% empty %}
            <li>None</li>
        {% endfor %}
    </div>
</div>
<div class="subcontainer sc_small right">
    <div class="subcontainer_h">
        Users working on this
    </div>
    <div class="subcontainer_c">
        {% for u in project.users.all %}
            <li><a href="{% url 'projects:profilepage' u.pk %}">{{ u }}</a></li>
        {% empty %}
            <li>None</li>
        {% endfor %}
    </div>
</div>
<div class="subcontainer sc_small right">
    <div class="subcontainer_h">
        Projecttree
    </div>
    <div class="subcontainer_c">
        {% for array in project.project_tree %}
            {% for b in array %}
                    {% autoescape off %}
                        <li><span class="mono">{{ b.1 }}</span>{% endautoescape %}<a href="{% url 'projects:projectpage' b.0.pk %}">{{ b.0.name }}</a></li>
            {% endfor %}
        {% endfor %}
    </div>
</div>
{% endblock %}
